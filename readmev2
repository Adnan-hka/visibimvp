# VISIBI â€“ AI Visibility Intelligence Platform  
### *MVP v2.1 â€“ Developer & Architecture Documentation*

VISIBI is an AI Visibility Analytics Platform that measures how often brands appear inside conversations across ChatGPT, Gemini, and Perplexity.

This repository contains:

- The VISIBI architecture
- Full MVP backend queue system (Supabase + Deno Worker)
- Database schema (with micro-task queue)
- AI prompt templates
- Output examples
- Dashboard logic
- Acceptance criteria
- Phase 2 roadmap

VISIBI enables brands to answer a simple but powerful question:

### **â€œWhere does my brand appear inside AI conversations?â€**

---

# ğŸš€ 1. Features (MVP v2.1)

### âœ” Seed-topic scanning  
### âœ” ChatGPT + Gemini + Perplexity visibility analysis  
### âœ” Brand mentions  
### âœ” Citation extraction  
### âœ” Competitor aggregation  
### âœ” Sentiment classification  
### âœ” Content-type insights  
### âœ” Supabase queue-based worker system  
### âœ” Dashboard (Next.js 14)  
### âœ” CSV export  

This MVP is built to scale safely with AI APIs and prevent timeouts.

---

# ğŸ§  2. System Architecture (Queue-Based Processing)

```mermaid
flowchart LR
    A[User Input Form] --> B[Supabase: scan_jobs]
    B --> C[DB Trigger: split_job]
    C --> D[job_tasks queue]
    D --> E[pg_cron calls Deno Worker]
    E --> F[AI Engines]
    F --> G[Parser and Scoring]
    G --> H[engine_results, citations, insights]
    H --> I[cron: check_job_completion]
    I --> J[scan_jobs.status = done]
    J --> K[Dashboard]
```

---

# 3. Repository Structure

```
visibi-platform/
â”‚
â”œâ”€â”€ README.md
â”‚
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ mvp-scope-contract.md
â”‚   â”œâ”€â”€ milestones.md
â”‚   â”œâ”€â”€ expected-output-examples.md
â”‚   â”œâ”€â”€ validation-checklist.md
â”‚   â”œâ”€â”€ ai-prompt-templates.md
â”‚   â”œâ”€â”€ supabase-schema.sql.md
â”‚   â”œâ”€â”€ deno-worker.md
â”‚   â”œâ”€â”€ phase-2-blueprint.md
â”‚
â”œâ”€â”€ frontend/
â”‚   â””â”€â”€ (Next.js app / dashboard)
â”‚
â””â”€â”€ supabase/
    â”œâ”€â”€ migrations/
    â””â”€â”€ functions/scan/index.ts
```

---

# 4. Technology Stack

| Layer          | Technology                                |
| -------------- | ----------------------------------------- |
| Frontend       | Next.js 14 + React Server Components      |
| Backend Worker | Supabase Edge Functions (Deno)            |
| Database       | PostgreSQL (Supabase)                     |
| Queue System   | `job_tasks` table + `pg_cron`             |
| Aggregation    | SQL RPC functions                         |
| AI Providers   | OpenAI ChatGPT, Google Gemini, Perplexity |

---

# 5. Installation

```bash
# Clone the repository
git clone https://github.com/Adnan-hka/visibimvp
cd visibi-platform

# Install frontend:
cd frontend
npm install
npm run dev

# Local Supabase
supabase start
# Deploy Edge Function
supabase functions deploy scan
```

---

# 6. Important Documentation

All documentation is inside the `/docs` directory:
| File                          | Description                                   |
| ----------------------------- | --------------------------------------------- |
| `mvp-scope-contract.md`       | Final agreed scope with developer             |
| `milestones.md`               | Fixed-milestone plan                          |
| `expected-output-examples.md` | Exact JSON structures the worker must produce |
| `validation-checklist.md`     | QA acceptance sheet                           |
| `ai-prompt-templates.md`      | Prompts used by the worker                    |
| `supabase-schema.sql.md`      | Full database + queue + cron SQL              |
| `deno-worker.md`              | Full Deno Edge worker code                    |
| `phase-2-blueprint.md`        | Future expansion                              |

---

# ğŸ§ª 7. Testing the Worker (Local)

```bash
curl -X POST http://localhost:54321/functions/v1/scan
```

---

# ğŸ§© 8. Dashboard (Next.js)

The dashboard polls the job until it is done, then displays:

- Visibility score per engine/topic
- Competitor share of voice
- Citation table
- Content insights
- CSV export

(See `expected-output-examples.md` for API shapes.)

---

# ğŸš¦ 9. Acceptance Criteria

The MVP is complete when:

- A new `scan_job` is created from the form
- The trigger creates `job_tasks`
- `pg_cron` picks tasks and runs them
- Worker completes all tasks
- `check_job_completion` marks job as done
- Dashboard displays correct data

The complete checklist is in `docs/validation-checklist.md`.

---

# ğŸŒ± 10. Phase 2 Roadmap

- Rolling 30-day visibility window
- Scheduled scans
- 100+ query expansions
- Multi-brand accounts
- GPT Browser mode scraping
- Regional engine variants
- Claude integration
- PDF/HTML report exports

(See `docs/phase-2-blueprint.md`.)

---

# ğŸ” 11. Environment Variables

```env
SUPABASE_URL=
SUPABASE_ANON_KEY=
SUPABASE_SERVICE_KEY=
OPENAI_API_KEY=
GEMINI_API_KEY=
PERPLEXITY_API_KEY=
```

---

# ğŸ“„ 12. License

Â© 2025 VISIBI â€“ All rights reserved.
